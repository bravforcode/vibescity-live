# Pentest Checklist: VibeCity UGC & Gamification

> **Target:** VibeCity.live UGC & Gamification API
> **Date:** 2026-01-31
> **Type:** Gray Box (Access to Source & Schema)

## Phase 1: Scope Definition

### Objectives
- [ ] Verify integrity of User Generated Content (UGC) submissions.
- [ ] Prevent gamification fraud (XP/Coin farming).
- [ ] Ensure user data privacy (RLS policies).

### In-Scope Assets
- **Database Tables**: `venues`, `user_submissions`, `user_stats`, `badges`.
- **RPC Functions**: `submit_venue`, `award_xp`, `check_badges`.
- **Frontend Components**: `AddShopModal`, `ProfileDrawer`.

---

## Phase 2: Vulnerability Assessment

### 1. UGC & Input Validation
- [ ] **XSS Injection**: Test `venue_name`, `description` with payload `<script>alert(1)</script>`.
- [ ] **SQL Injection**: Test RPC parameters with `' OR 1=1 --`.
- [ ] **Coordinate Fuzzing**: Submit venues with invalid Lat/Lng (e.g., `999, 999`) or Null Island `0,0`.
- [ ] **Payload Size**: Attempt to submit valid JSON > 5MB to `submit_venue`.

### 2. Gamification Integrity (Anti-Fraud)
- [ ] **XP Farming**: Call `award_xp` rapidly (Rate Limiting check).
- [ ] **Badge Glitching**: Trigger `check_badges` continuously to duplicate rewards.
- [ ] **Negative Values**: Attempt to submit negative coins or XP.

### 3. Access Control (IDOR & RLS)
- [ ] **Edit Authorization**: Attempt to edit a venue owned by another user.
- [ ] **Submission Visibility**: Verify `user_submissions` are private until approved.
- [ ] **Profile Privacy**: Check if `user_stats` of other users can be modified.

---

## Phase 3: Automated Scanning Plan

### Tools
- **Static Analysis**: `biome lint` (Completed).
- **Dynamic Analysis**: Mapbox Token scope verification.
- **Database Audit**: Review Supabase RLS policies for `public` role leaks.

---

## Phase 4: Remediation Plan

- [ ] **Critical**: Fix any RLS bypass immediately.
- [ ] **High**: Implement rate limiting on `submit_venue` if missing.
- [ ] **Medium**: Sanitize HTML output in descriptions.
